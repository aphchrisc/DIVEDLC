<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Enhanced interactive index for the DIVE Data Learning Cohort: searchable, filterable, and accessible video guide." />
  <title>DIVE Data Learning Cohort — Enhanced Video Index</title>
  <style>
    /* Enhanced Index — MVP */
    :root {
      --bg: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --brand: #1e40af;
      --brand-2: #3b82f6;
      --surface: #f8fafc;
      --surface-2: #ffffff;
      --ring: #93c5fd;
      --radius: 12px;
      --radius-sm: 8px;
      --shadow: 0 1px 2px rgba(0,0,0,0.06), 0 2px 6px rgba(0,0,0,0.06);
      --shadow-hover: 0 4px 10px rgba(0,0,0,0.10);
      --maxw: 1200px;
      --toc-w: 280px;
      --gap: 16px;
      --transition: 180ms cubic-bezier(.2,.7,.2,1);
    }
    [data-theme="dark"] {
      --bg: #0b1220;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --brand: #93c5fd;
      --brand-2: #60a5fa;
      --surface: #0f172a;
      --surface-2: #111827;
      --ring: #60a5fa;
      --shadow: 0 1px 2px rgba(0,0,0,0.6), 0 2px 6px rgba(0,0,0,0.5);
      --shadow-hover: 0 6px 16px rgba(0,0,0,0.6);
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; color: var(--text); background: var(--bg); line-height: 1.6; }
    a { color: var(--brand); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .sr-only { position: absolute !important; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }
    :focus-visible { outline: 3px solid var(--ring); outline-offset: 2px; border-radius: 6px; }

    /* Progress */
    .progress-wrap { position: sticky; top: 0; left: 0; right: 0; height: 4px; background: rgba(30,64,175,0.12); z-index: 1000; }
    .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, var(--brand), var(--brand-2)); transition: width var(--transition); }

    /* Hero */
    .hero { background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 55%, #3b82f6 100%); color: white; padding: 56px 20px; }
    .container { max-width: var(--maxw); margin: 0 auto; }
    .hero h1 { margin: 0 0 8px 0; font-size: 2.6rem; line-height: 1.2; }
    .hero .subtitle { font-size: 1.1rem; opacity: 0.95; margin: 0 0 16px 0; }
    .timeline { display: inline-flex; gap: 8px; flex-wrap: wrap; background: rgba(255,255,255,0.12); padding: 8px 12px; border-radius: 999px; backdrop-filter: blur(8px); }
    .timeline .dot { width: 6px; height: 6px; border-radius: 50%; background: white; opacity: 0.9; margin: 10px 4px 0 4px; }

    /* Layout */
    .main { display: grid; grid-template-columns: minmax(0, var(--toc-w)) 1fr; gap: 24px; max-width: var(--maxw); margin: 24px auto; padding: 0 16px; }

    /* TOC */
    .toc { position: sticky; top: 72px; align-self: start; padding: 12px 8px; background: var(--surface); border-radius: 10px; border: 1px solid #e5e7eb; }
    .toc h2 { font-size: 0.95rem; margin: 0 0 8px 8px; color: #334155; }
    .toc button.toc-toggle { display: none; }
    .toc ul { list-style: none; padding: 0; margin: 0; }
    .toc li { margin: 4px 0; }
    .toc a { display: block; padding: 6px 10px; border-radius: 6px; color: #1f2937; }
    .toc a:hover, .toc a:focus { background: #e5efff; outline: none; }
    .toc .chip-mini { float: right; font-size: 0.73rem; padding: 1px 6px; border-radius: 999px; background: #eef2ff; color: #1e40af; border: 1px solid #c7d2fe; margin-left: 8px; }

    /* Toolbar */
    .toolbar { position: sticky; top: 72px; z-index: 500; background: var(--bg); padding: 12px; border: 1px solid #e5e7eb; border-radius: 10px; box-shadow: var(--shadow); }
    .toolbar .row { display: grid; grid-template-columns: 1fr 160px 160px auto auto; gap: 8px; align-items: center; }
    .toolbar input[type="search"], .toolbar select { width: 100%; padding: 10px 12px; border-radius: 8px; border: 1px solid #d1d5db; font-size: 0.95rem; }
    .toolbar button, .toolbar a.button { padding: 10px 12px; border-radius: 8px; border: 1px solid #d1d5db; background: #f9fafb; cursor: pointer; font-size: 0.95rem; color: #111827; text-decoration: none; text-align: center; transition: background var(--transition), box-shadow var(--transition); }
    .toolbar button:hover, .toolbar a.button:hover { background: #eef2ff; }
    .toolbar .hint { margin-top: 6px; color: var(--muted); font-size: 0.85rem; }

    /* Sections + grid */
    .section { margin: 24px 0 16px; }
    .section h3 { margin: 0 0 8px 0; font-size: 1.25rem; color: #0f172a; border-left: 4px solid var(--brand-2); padding-left: 8px; }
    .grid { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: var(--gap); }
    @media (max-width: 1080px) { .grid { grid-template-columns: repeat(2, minmax(0,1fr)); } }
    @media (max-width: 640px) { .grid { grid-template-columns: 1fr; } }

    /* Card */
    .card { background: var(--surface-2); border: 1px solid #e5e7eb; border-radius: var(--radius); box-shadow: var(--shadow); padding: 12px; display: grid; grid-template-rows: auto 1fr auto; min-height: 140px; transition: box-shadow var(--transition), transform var(--transition); }
    .card:hover { box-shadow: var(--shadow-hover); transform: translateY(-1px); }
    .thumb { width: 100%; aspect-ratio: 16 / 9; object-fit: cover; border-radius: calc(var(--radius) - 2px); margin-bottom: 10px; border: 1px solid #e5e7eb; background: #e5e7eb; }
    .card .title { font-weight: 600; margin: 0 0 6px 0; line-height: 1.35; }
    .card .title a { color: #0f172a; }
    .meta { display: flex; align-items: center; gap: 8px; color: var(--muted); font-size: 0.9rem; margin-bottom: 8px; }
    .chip { display: inline-block; font-size: 0.75rem; padding: 2px 8px; border-radius: 999px; background: #eff6ff; color: #1e40af; border: 1px solid #bfdbfe; }
    .desc { color: #334155; font-size: 0.95rem; }
    .actions { display: flex; gap: 8px; margin-top: 10px; }
    .btn { padding: 8px 10px; border-radius: var(--radius-sm); border: 1px solid #d1d5db; background: #f8fafc; color: #0f172a; cursor: pointer; font-size: 0.9rem; }
    .btn:hover { background: #eef2ff; }
    .btn[aria-pressed="true"] { background: #dbeafe; border-color: #93c5fd; }
    .hidden { display: none !important; }
    .notes { margin-top: 8px; }
    .notes[hidden] { display: none !important; }
    .notes textarea { width: 100%; min-height: 80px; padding: 8px; border-radius: 8px; border: 1px solid #d1d5db; font-family: inherit; font-size: 0.9rem; }

    /* Section progress */
    .section-head { display: flex; align-items: baseline; gap: 12px; }
    .section .progress-line { flex: none; height: 6px; background: #e5e7eb; border-radius: 999px; overflow: hidden; width: 160px; }
    .section .progress-fill { height: 100%; background: linear-gradient(90deg, var(--brand), var(--brand-2)); width: 0%; transition: width var(--transition); }

    /* Placeholder */
    #content { min-height: 240px; }
    .placeholder { color: var(--muted); padding: 24px; border: 2px dashed #e5e7eb; border-radius: 12px; background: #fff; text-align: center; }

    /* Print */
    @media print {
      .hero, .toc, .toolbar, .progress-wrap { display: none !important; }
      .main { display: block; margin: 0; padding: 0; }
      .section { break-inside: avoid; page-break-inside: avoid; margin: 0 0 8px 0; }
      .section h3 { border: none; font-size: 1.1rem; margin: 12px 0 6px; }
      .grid { display: block; }
      .card { box-shadow: none; border: 1px solid #cbd5e1; margin: 0 0 6px 0; padding: 8px; }
      .actions { display: none !important; }
      a::after { content: " (" attr(href) ")"; font-size: 0.75rem; color: #475569; }
    }

    /* Responsive */
    @media (max-width: 980px) {
      .main { grid-template-columns: 1fr; }
      .toc { order: 2; position: static; }
      .toolbar { position: sticky; top: 72px; order: 1; }
      .toc button.toc-toggle { display: inline-flex; align-items: center; gap: 6px; padding: 8px 10px; margin: 4px 8px 8px; border-radius: 8px; border: 1px solid #d1d5db; background: #fff; }
      .toolbar .row { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>
  <!-- Accessibility: skip to content -->
  <a class="sr-only" href="#content">Skip to content</a>

  <!-- Global progress (0% initial; will reflect watched progress later) -->
  <div class="progress-wrap" aria-hidden="true">
    <div id="progress-bar" class="progress-bar" style="width: 0%;"></div>
  </div>

  <!-- Hero -->
  <header class="hero" role="banner">
    <div class="container">
      <h1>DIVE Data Learning Cohort</h1>
      <p class="subtitle">Enhanced Video Index: search, filter, and track your progress across phases.</p>
      <div class="timeline" aria-label="Project phases">
        <span>Problem</span><span class="dot" aria-hidden="true"></span>
        <span>Data</span><span class="dot" aria-hidden="true"></span>
        <span>Pipeline</span><span class="dot" aria-hidden="true"></span>
        <span>Evaluation</span><span class="dot" aria-hidden="true"></span>
        <span>Story & Delivery</span>
      </div>
    </div>
  </header>

  <main class="main" id="main" role="main">
    <!-- Sticky TOC -->
    <nav id="toc" class="toc" aria-label="On this page">
      <h2>Sections</h2>
      <button class="toc-toggle" type="button" aria-expanded="false" aria-controls="toc-list">Show/Hide sections</button>
      <ul id="toc-list">
        <li><a href="#section-A">A) Framing & Scoping</a></li>
        <li><a href="#section-B">B) Visual Storytelling</a></li>
        <li><a href="#section-C">C) BI Modeling & Dashboard Craft</a></li>
        <li><a href="#section-D">D) Data Quality & Pipelines</a></li>
        <li><a href="#section-E">E) Evaluation & ML Metrics</a></li>
        <li><a href="#section-F">F) Public-Sector Exemplars</a></li>
        <li><a href="#section-G">G) Ethics, Privacy & Risk</a></li>
      </ul>
    </nav>

    <section aria-labelledby="toolbar-title" class="toolbar" role="region">
      <h2 id="toolbar-title" class="sr-only">Search and filters</h2>
      <div class="row" role="group" aria-label="Search and filter controls">
        <input id="search" type="search" placeholder="Search videos, channels, or reasons to watch…" aria-label="Search videos" />
        <select id="filter-section" aria-label="Filter by section">
          <option value="">All sections</option>
          <option value="A">A — Framing & Scoping</option>
          <option value="B">B — Visual Storytelling</option>
          <option value="C">C — BI Modeling & Dashboard</option>
          <option value="D">D — Data Quality & Pipelines</option>
          <option value="E">E — Evaluation & ML Metrics</option>
          <option value="F">F — Public-Sector Exemplars</option>
          <option value="G">G — Ethics, Privacy & Risk</option>
        </select>
        <select id="filter-channel" aria-label="Filter by channel">
          <option value="">All channels</option>
        </select>
        <button id="filter-watchlist" type="button" aria-pressed="false" title="Show watchlist only">Watchlist</button>
        <button id="filter-watched" type="button" aria-pressed="false" title="Show watched">Watched</button>
        <button id="theme-toggle" type="button" aria-pressed="false" title="Toggle dark mode">Dark</button>
        <button id="export-notes" type="button" title="Export notes as Markdown">Export Notes</button>
        <button id="export-state" type="button" title="Export watch state">Export State</button>
        <button id="import-state" type="button" title="Import watch state">Import State</button>
        <input id="import-file" type="file" accept="application/json" class="sr-only" aria-hidden="true" />
      </div>
      <p class="hint">Tip: Press “/” to focus search. Filters and watchlist persist on this device.</p>
    </section>

    <section id="content" aria-label="Video results">
      <div id="loading" class="placeholder">This page has been superseded by the new modular build. Open the <a href="index.html">enhanced index</a>.</div>
      <!-- Sections will be rendered here -->
    </section>
  </main>

  <!-- Embedded source content (standalone): sections A–G copied from the original file -->
  <template id="dive-source">
    <h2>A) Framing & Scoping (Problem → Decision → Outcome)</h2>
    <div class="section-intro">
        <p>Start here. These talks orient projects around a decision and a measurable outcome. Use them when drafting your Problem Statement and defining success criteria.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=SE9RtxkTXO8" target="_blank">What is Decision Science? (with Cassie Kozyrkov)</a></div>
                </td>
                <td class="channel">DataFramed / Cassie Kozyrkov</td>
                <td class="description">Defines decision-first analytics; aligns DS work to actions and metrics.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="#" target="_blank">The most important rule of decision-making</a></div>
                </td>
                <td class="channel">Cassie Kozyrkov</td>
                <td class="description">Outcome bias & disciplined framing; great for kickoff mindset.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="#" target="_blank">Decision Intelligence Q&A</a></div>
                </td>
                <td class="channel">Cassie Kozyrkov</td>
                <td class="description">Rapid Q&A format on decisions, metrics, validation.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="#" target="_blank">Making Better Decisions with Cassie Kozyrkov</a></div>
                </td>
                <td class="channel">The Analytics Show Podcast (YouTube)</td>
                <td class="description">Broader view of decision intelligence in organizations.</td>
            </tr>
        </tbody>
    </table>

    <h2>B) Visual Storytelling & Executive Communication</h2>
    <div class="section-intro">
        <p>Turn analysis into action. These picks teach visual hierarchy, narrative arcs, and the 'So-what → Now-what' close for executive audiences.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=8jExYdy5xzA" target="_blank">Effective Data Storytelling (Brent Dykes)</a></div>
                </td>
                <td class="channel">Brent Dykes / conference talk</td>
                <td class="description">Narrative structure and action-oriented insights.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=8EMW7io4rSI" target="_blank">Storytelling with Data (Talks at Google) – Cole Nussbaumer Knaflic</a></div>
                </td>
                <td class="channel">Talks at Google</td>
                <td class="description">Makeovers; audience-first design; chart choice.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=hVimVzgtD6w" target="_blank">The best stats you've ever seen</a></div>
                </td>
                <td class="channel">TED (Hans Rosling)</td>
                <td class="description">Benchmark example of engaging, decision-relevant storytelling.</td>
            </tr>
        </tbody>
    </table>

    <h2>C) BI Modeling & Dashboard Craft (Power BI & Tableau)</h2>
    <div class="section-intro">
        <p>For teams building dashboards. Model with a star schema, scope to an executive 'page one,' and plan for security, accessibility, and performance.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=RXJg8lDk0SM" target="_blank">Why You Should Use a Star Schema in Power BI</a></div>
                </td>
                <td class="channel">Guy in a Cube</td>
                <td class="description">Clear case for facts + dimensions; keeps DAX simpler and faster.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=8qBWJxGayZQ" target="_blank">Star schema vs. flat tables (SQLBI)</a></div>
                </td>
                <td class="channel">SQLBI</td>
                <td class="description">Deep dive on star vs. flat models; performance implications.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=5Dx3jXoI64E" target="_blank">Why your model isn’t working (header/detail pitfalls)</a></div>
                </td>
                <td class="channel">SQLBI</td>
                <td class="description">When a flat/header-detail model fails and how to refactor.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=dw7zkr4o02g" target="_blank">Executive Dashboard in Tableau (transferable to PBI)</a></div>
                </td>
                <td class="channel">Tableau Builds</td>
                <td class="description">One-page executive view + drill-downs (transferable to PBI).</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=rY2lO9jZ3O4" target="_blank">Power BI Dashboard Design — From Start to Finish</a></div>
                </td>
                <td class="channel">How to Power BI</td>
                <td class="description">Practical PBI design flow; layout, hierarchy, and filters.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=Z0c2qjHeFds" target="_blank">10 Design Tips for Better Power BI Dashboards</a></div>
                </td>
                <td class="channel">How to Power BI</td>
                <td class="description">Quick design wins: typography, spacing, and visual polish.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=7wH7y5hDqbs" target="_blank">Row-Level Security (RLS) in Power BI — Basics</a></div>
                </td>
                <td class="channel">Guy in a Cube</td>
                <td class="description">Foundation for securing data by audience/role.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/playlist?list=PLv2BtOtLblH1dBK34FqClo2eXXQgWW1ui" target="_blank">Using Row-Level Security (RLS) in Power BI (Playlist)</a></div>
                </td>
                <td class="channel">Guy in a Cube</td>
                <td class="description">Patterns for dynamic RLS and org hierarchies.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://learn.microsoft.com/en-us/power-bi/create-reports/desktop-accessibility-creating-reports" target="_blank">Creating accessible Power BI reports (Microsoft)</a></div>
                </td>
                <td class="channel">Microsoft Power BI</td>
                <td class="description">Official guidance: contrast, keyboard nav, alt text, tab order.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=Gj4wQeYlRn0" target="_blank">Color-Blind Friendly Power BI Reports – Complete Guide</a></div>
                </td>
                <td class="channel">BI tutorials / community</td>
                <td class="description">WCAG basics and color-blind-safe palettes in PBI.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=EhGF372t0sU" target="_blank">The How and Why of Power BI Aggregations</a></div>
                </td>
                <td class="channel">Guy in a Cube</td>
                <td class="description">Scale large models and keep visuals fast.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=ivWGSnthTDw" target="_blank">Are you HITTING your Power BI aggregations?</a></div>
                </td>
                <td class="channel">Guy in a Cube</td>
                <td class="description">Verification + troubleshooting for aggregation usage.</td>
            </tr>
        </tbody>
    </table>

    <h2>D) Data Quality & Reproducible Pipelines</h2>
    <div class="section-intro">
        <p>Build trust and make refreshable outputs. These walk through data testing (Great Expectations), analytics engineering (dbt), and scheduling (Airflow) — plus a project scaffold.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=F3yvXqzkDhU" target="_blank">Great Expectations (official channel)</a></div>
                </td>
                <td class="channel">Great Expectations</td>
                <td class="description">Data tests as contracts; docs and profiling patterns.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=klZPfU06Lbo" target="_blank">Great Expectations: Data Quality Testing overview</a></div>
                </td>
                <td class="channel">Conference/Meetup demo</td>
                <td class="description">Why expectations; how to integrate in a pipeline.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=klZPfU06Lbo" target="_blank">Use Great Expectations inside Airflow pipelines</a></div>
                </td>
                <td class="channel">Practical demo</td>
                <td class="description">Embed validation in scheduled DAGs.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=M8oi7nSaWps" target="_blank">Introduction to dbt (Fishtown/dbt Labs)</a></div>
                </td>
                <td class="channel">dbt Labs (Fishtown Analytics)</td>
                <td class="description">Core concepts: models, tests, sources, docs.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=mWvW-nDZrgI" target="_blank">dbt Crash Course for Beginners (Full Tutorial)</a></div>
                </td>
                <td class="channel">Community tutorial</td>
                <td class="description">Hands-on getting started; project structure.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=xUKIL7zsjos" target="_blank">Airflow Tutorial for Beginners — Full Course</a></div>
                </td>
                <td class="channel">coder2j</td>
                <td class="description">Scheduling basics; DAGs; operators; best practices.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=xUKIL7zsjos" target="_blank">What is Apache Airflow? (beginner overview)</a></div>
                </td>
                <td class="channel">Data with Marc</td>
                <td class="description">Short conceptual intro to the orchestrator.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=mWvW-nDZrgI" target="_blank">Cookiecutter Data Science (why & how)</a></div>
                </td>
                <td class="channel">The Data Scientist / community talks</td>
                <td class="description">Standard project scaffold for reproducibility.</td>
            </tr>
        </tbody>
    </table>

    <h2>E) Evaluation & ML Metrics (Only if your project needs ML)</h2>
    <div class="section-intro">
        <p>Right-size ML. Establish a baseline and pick metrics that reflect real-world risk trade-offs. These explain ROC/AUC, precision/recall/F1, and validation.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=4jRBRDbJemM" target="_blank">ROC and AUC, Clearly Explained!</a></div>
                </td>
                <td class="channel">StatQuest with Josh Starmer</td>
                <td class="description">Intuitive explanation of ROC curves and AUC.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=vP06aMoz4v8" target="_blank">Sensitivity & Specificity (ML fundamentals)</a></div>
                </td>
                <td class="channel">StatQuest with Josh Starmer</td>
                <td class="description">Understand false-positive/false-negative trade-offs.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=8d3JbbSj-I8" target="_blank">Precision, Recall & F1 Score — Intuitively Explained</a></div>
                </td>
                <td class="channel">Krish Naik</td>
                <td class="description">When to prefer precision vs. recall; F1 in practice.</td>
            </tr>
        </tbody>
    </table>

    <h2>F) Public-Sector Exemplars (Context you'll recognize)</h2>
    <div class="section-intro">
        <p>Case-driven inspiration from civic and public-safety contexts. Useful for KPI ideas and executive views that resonate with government audiences.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=IPjvEapHmSg" target="_blank">Power BI for Government — Community of Practice (Playlist)</a></div>
                </td>
                <td class="channel">DataTaleAU</td>
                <td class="description">Recurring showcase of government-specific patterns.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=sVXjAIa7YBs" target="_blank">Build a Crime Dashboard in Power BI (Manchester PD example)</a></div>
                </td>
                <td class="channel">Data tutorials</td>
                <td class="description">End-to-end municipal data example; filters and trends.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=afnoUt5noAw" target="_blank">Data Visualization for Proactive Government Decision-making</a></div>
                </td>
                <td class="channel">Practical workshop</td>
                <td class="description">Framing dashboards for policy/action; hands-on build with public data and KPIs.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=lWnROuGSIQo" target="_blank">City of Austin: Clarity with Custom Built Power BI Dashboards</a></div>
                </td>
                <td class="channel">KVUE / local news</td>
                <td class="description">Local context and stakeholder expectations.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=KPh9Xjou2KI" target="_blank">Power BI Showcase: Local Government Showcase</a></div>
                </td>
                <td class="channel">Local Government</td>
                <td class="description">KPI sets common in municipal exec views.</td>
            </tr>
        </tbody>
    </table>

    <h2>G) Ethics, Privacy & Risk (Civic analytics must-haves)</h2>
    <div class="section-intro">
        <p>Responsible analytics in government: de-identification, data governance, and accessibility standards that keep projects safe and useful.</p>
    </div>
    
    <table>
        <thead>
            <tr>
                <th style="width: 35%;">Video</th>
                <th style="width: 25%;">Channel</th>
                <th style="width: 40%;">Why watch</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=BbFCbWIn-as" target="_blank">Protecting Sensitive Data in Huge Datasets (Cloud Next '19)</a></div>
                </td>
                <td class="channel">Google Cloud Tech</td>
                <td class="description">DLP patterns for masking/redaction and risk reduction.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/watch?v=uoa6Q2JWGY4" target="_blank">Let's talk about data quality! (Government Analysis Function)</a></div>
                </td>
                <td class="channel">UK Government Analysis Function (playlist)</td>
                <td class="description">Practical quality framework from a public-sector team.</td>
            </tr>
            <tr>
                <td>
                    <div class="video-title"><a href="https://www.youtube.com/channel/UCVY5YwwgpprO_2KEYz-cVrw/videos" target="_blank">Digital ethics in the public sector — Government Analysis Function</a></div>
                </td>
                <td class="channel">Public sector panel</td>
                <td class="description">Ethics principles to apply to data projects.</td>
            </tr>
        </tbody>
    </table>
  </template>

  <noscript>
    <div class="container" style="margin: 24px auto; padding: 16px;">
      <p>JavaScript is disabled. You can still access the reference index here: <a href="dive_cohort_guide.html">DIVE Cohort Guide (original)</a>.</p>
    </div>
  </noscript>

  <script>
    (function() {
      document.documentElement.classList.add('js');

      const SELECTORS = {
        content: document.getElementById('content'),
        loading: document.getElementById('loading'),
        search: document.getElementById('search'),
        filterSection: document.getElementById('filter-section'),
        filterChannel: document.getElementById('filter-channel'),
        filterWatchlist: document.getElementById('filter-watchlist'),
        filterWatched: document.getElementById('filter-watched'),
        progressBar: document.getElementById('progress-bar'),
        themeToggle: document.getElementById('theme-toggle'),
        sourceTpl: document.getElementById('dive-source'),
        tocEl: document.getElementById('toc')
      };

      const state = {
        items: [],
        channels: new Set(),
        filters: { q: '', section: '', channel: '', watchlistOnly: false, watchedOnly: false },
        watchlist: new Set(JSON.parse(localStorage.getItem('dive:watchlist') || '[]')),
        watched: new Set(JSON.parse(localStorage.getItem('dive:watched') || '[]')),
        theme: localStorage.getItem('dive:theme') || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
      };

      // Cookie helpers (for GitHub Pages persistence)
      function setCookie(name, value, days) {
        const exp = new Date();
        exp.setTime(exp.getTime() + (days*24*60*60*1000));
        document.cookie = `${name}=${encodeURIComponent(value)}; expires=${exp.toUTCString()}; path=/; SameSite=Lax`;
      }
      function getCookie(name) {
        const m = document.cookie.match(new RegExp('(?:^|; )' + name.replace(/([.$?*|{}()\[\]\\\/\+^])/g, '\\$1') + '=([^;]*)'));
        return m ? decodeURIComponent(m[1]) : null;
      }
      function persist() {
        const wl = JSON.stringify(Array.from(state.watchlist));
        const wd = JSON.stringify(Array.from(state.watched));
        localStorage.setItem('dive:watchlist', wl);
        localStorage.setItem('dive:watched', wd);
        // Mirror to cookies (180 days)
        setCookie('dive_watchlist', wl, 180);
        setCookie('dive_watched', wd, 180);
      }

      // Load cookies if present (merge with localStorage)
      (function loadCookies(){
        try {
          const wl = getCookie('dive_watchlist');
          if (wl) JSON.parse(wl).forEach(id => state.watchlist.add(id));
          const wd = getCookie('dive_watched');
          if (wd) JSON.parse(wd).forEach(id => state.watched.add(id));
        } catch {}
      })();

      function idFor(href, title) {
        return (href && href !== '#') ? 'vid:' + href : 'vid:' + title.trim().toLowerCase().replace(/\s+/g, '-');
      }

      function buildSections(items) {
        const bySection = items.reduce((acc, it) => {
          (acc[it.sectionCode] = acc[it.sectionCode] || { title: it.sectionTitle, code: it.sectionCode, items: [] }).items.push(it);
          return acc;
        }, {});
        const order = ['A','B','C','D','E','F','G'];
        return order.filter(k => bySection[k]).map(k => bySection[k]);
      }

      function render() {
        if (!state.items.length) return;
        SELECTORS.content.innerHTML = '';
        const sections = buildSections(state.items);
        let total = 0, watched = 0;
        // Precompute per-section progress (based on all items, not filtered)
        const perSection = sections.reduce((acc, s) => {
          const items = state.items.filter(it => it.sectionCode === s.code);
          const w = items.filter(it => state.watched.has(it.id)).length;
          acc[s.code] = { total: items.length, watched: w };
          return acc;
        }, {});
        sections.forEach(section => {
          const secEl = document.createElement('section');
          secEl.className = 'section';
          secEl.id = 'section-' + section.code;
          const head = document.createElement('div');
          head.className = 'section-head';
          const h = document.createElement('h3');
          h.textContent = section.code + ') ' + section.title;
          const line = document.createElement('div');
          line.className = 'progress-line';
          const fill = document.createElement('div');
          fill.className = 'progress-fill';
          const meta = perSection[section.code] || { total: 0, watched: 0 };
          const pct = meta.total ? Math.round((meta.watched/meta.total)*100) : 0;
          fill.style.width = pct + '%';
          line.appendChild(fill);
          head.appendChild(h);
          head.appendChild(line);
          secEl.appendChild(head);

          const grid = document.createElement('div');
          grid.className = 'grid';

          section.items.forEach(item => {
            total += 1;
            const isWatched = state.watched.has(item.id);
            if (isWatched) watched += 1;

            if (!matchesFilters(item)) return; // filtered out

            const card = document.createElement('article');
            card.className = 'card';
            card.setAttribute('data-id', item.id);
            card.setAttribute('data-section', item.sectionCode);
            card.setAttribute('data-channel', item.channel);

            const thumbUrl = youTubeThumb(item.href);
            if (thumbUrl) {
              const img = document.createElement('img');
              img.loading = 'lazy';
              img.decoding = 'async';
              img.src = thumbUrl;
              img.alt = '';
              img.className = 'thumb';
              card.appendChild(img);
            }

            const t = document.createElement('h4');
            t.className = 'title';
            const a = document.createElement('a');
            a.href = item.href || '#';
            a.target = '_blank';
            a.rel = 'noopener noreferrer';
            a.textContent = item.title;
            a.id = item.id;
            t.appendChild(a);

            const meta = document.createElement('div');
            meta.className = 'meta';
            const chip = document.createElement('span');
            chip.className = 'chip';
            chip.textContent = item.channel || 'Channel';
            meta.appendChild(chip);

            const desc = document.createElement('div');
            desc.className = 'desc';
            desc.textContent = item.description || '';

            const actions = document.createElement('div');
            actions.className = 'actions';
            const btnSave = document.createElement('button');
            btnSave.className = 'btn';
            btnSave.type = 'button';
            btnSave.setAttribute('aria-pressed', state.watchlist.has(item.id) ? 'true' : 'false');
            btnSave.textContent = state.watchlist.has(item.id) ? 'Saved' : 'Add to Watchlist';
            btnSave.addEventListener('click', () => {
              const pressed = btnSave.getAttribute('aria-pressed') === 'true';
              if (pressed) { state.watchlist.delete(item.id); }
              else { state.watchlist.add(item.id); }
              btnSave.setAttribute('aria-pressed', String(!pressed));
              btnSave.textContent = !pressed ? 'Saved' : 'Add to Watchlist';
              persist();
            });

            const btnWatched = document.createElement('button');
            btnWatched.className = 'btn';
            btnWatched.type = 'button';
            btnWatched.setAttribute('aria-pressed', isWatched ? 'true' : 'false');
            btnWatched.textContent = isWatched ? 'Watched' : 'Mark Watched';
            btnWatched.addEventListener('click', () => {
              const pressed = btnWatched.getAttribute('aria-pressed') === 'true';
              if (pressed) { state.watched.delete(item.id); }
              else { state.watched.add(item.id); }
              btnWatched.setAttribute('aria-pressed', String(!pressed));
              btnWatched.textContent = !pressed ? 'Watched' : 'Mark Watched';
              persist();
              updateProgress();
              // Update section progress line immediately
              const s = card.closest('.section');
              if (s) {
                const code = item.sectionCode;
                const totals = perSection[code];
                if (totals) {
                  totals.watched = state.items.filter(it => it.sectionCode === code && state.watched.has(it.id)).length;
                  const pct2 = totals.total ? Math.round((totals.watched/totals.total)*100) : 0;
                  const f = s.querySelector('.progress-fill');
                  if (f) f.style.width = pct2 + '%';
                }
              }
              // Update TOC chip in place
              const tocLink = document.querySelector('#toc a[href="#section-'+item.sectionCode+'"]');
              if (tocLink) {
                let chip = tocLink.querySelector('.chip-mini');
                if (!chip) { chip = document.createElement('span'); chip.className = 'chip-mini'; tocLink.appendChild(chip); }
                const itemsInSection = state.items.filter(it => it.sectionCode === item.sectionCode);
                const watchedInSection = itemsInSection.filter(it => state.watched.has(it.id)).length;
                chip.textContent = `${watchedInSection}/${itemsInSection.length}`;
              }
            });

            const btnNotes = document.createElement('button');
            btnNotes.className = 'btn';
            btnNotes.type = 'button';
            btnNotes.textContent = 'Notes';
            btnNotes.setAttribute('aria-expanded', 'false');
            const notesWrap = document.createElement('div');
            notesWrap.className = 'notes';
            notesWrap.hidden = true;
            const ta = document.createElement('textarea');
            ta.placeholder = 'Your notes (saved locally)…';
            ta.value = (localStorage.getItem('dive:notes:'+item.id) || '');
            ta.addEventListener('input', () => {
              // Sanitize: plain text only
              const val = String(ta.value).replace(/[\u0000-\u001F\u007F]/g, '');
              localStorage.setItem('dive:notes:'+item.id, val);
            });
            notesWrap.appendChild(ta);
            btnNotes.addEventListener('click', () => {
              const expanded = btnNotes.getAttribute('aria-expanded') === 'true';
              btnNotes.setAttribute('aria-expanded', String(!expanded));
              notesWrap.hidden = expanded;
            });

            actions.appendChild(btnSave);
            actions.appendChild(btnWatched);
            actions.appendChild(btnNotes);

            card.appendChild(t);
            card.appendChild(meta);
            card.appendChild(desc);
            card.appendChild(actions);
            card.appendChild(notesWrap);
            grid.appendChild(card);
          });

          secEl.appendChild(grid);
          SELECTORS.content.appendChild(secEl);
        });

        updateProgress(total, watched);
        ensureDeepLink();
        // Initialize roving tabindex: first card focusable
        const cards = Array.from(document.querySelectorAll('.card'));
        cards.forEach((c,i)=>{ c.tabIndex = (i===0?0:-1); });
        updateTocChips(perSection);
      }

      function updateTocChips(perSection) {
        const toc = SELECTORS.tocEl;
        if (!toc) return;
        const links = Array.from(toc.querySelectorAll('a[href^="#section-"]'));
        links.forEach(a => {
          const m = a.getAttribute('href').match(/^#section-([A-G])$/);
          if (!m) return;
          const code = m[1];
          const data = perSection[code] || { total: 0, watched: 0 };
          let chip = a.querySelector('.chip-mini');
          if (!chip) { chip = document.createElement('span'); chip.className = 'chip-mini'; a.appendChild(chip); }
          chip.textContent = data.total ? `${data.watched}/${data.total}` : '0/0';
        });
      }

      function matchesFilters(item) {
        const f = state.filters;
        if (f.section && item.sectionCode !== f.section) return false;
        if (f.channel && item.channel !== f.channel) return false;
        if (f.watchlistOnly && !state.watchlist.has(item.id)) return false;
        if (f.watchedOnly && !state.watched.has(item.id)) return false;
        if (f.q) {
          const q = f.q.toLowerCase();
          const hay = (item.title + ' ' + (item.channel||'') + ' ' + (item.description||'')).toLowerCase();
          if (!hay.includes(q)) return false;
        }
        return true;
      }

      function updateProgress(totalOverride, watchedOverride) {
        const total = totalOverride ?? state.items.length;
        const watched = watchedOverride ?? Array.from(state.watched).length;
        const pct = total ? Math.round((watched / total) * 100) : 0;
        if (SELECTORS.progressBar) SELECTORS.progressBar.style.width = pct + '%';
      }

      function ensureDeepLink() {
        if (location.hash) {
          const id = location.hash.slice(1);
          const el = document.getElementById(id);
          if (el) {
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            const card = el.closest('.card');
            if (card) {
              const orig = card.style.boxShadow;
              card.style.boxShadow = '0 0 0 3px #93c5fd';
              setTimeout(() => { card.style.boxShadow = orig; }, 1200);
            }
          }
        }
      }

      function setUpControls() {
        SELECTORS.search?.addEventListener('input', e => {
          state.filters.q = e.target.value.trim();
          render();
          updateUrlFromFilters();
        });
        SELECTORS.filterSection?.addEventListener('change', e => {
          state.filters.section = e.target.value;
          render();
          updateUrlFromFilters();
        });
        SELECTORS.filterChannel?.addEventListener('change', e => {
          state.filters.channel = e.target.value;
          render();
          updateUrlFromFilters();
        });
        SELECTORS.filterWatchlist?.addEventListener('click', () => {
          state.filters.watchlistOnly = !state.filters.watchlistOnly;
          SELECTORS.filterWatchlist.setAttribute('aria-pressed', String(state.filters.watchlistOnly));
          render();
          updateUrlFromFilters();
        });
        SELECTORS.filterWatched?.addEventListener('click', () => {
          state.filters.watchedOnly = !state.filters.watchedOnly;
          SELECTORS.filterWatched.setAttribute('aria-pressed', String(state.filters.watchedOnly));
          render();
          updateUrlFromFilters();
        });
        window.addEventListener('hashchange', ensureDeepLink);
        window.addEventListener('keydown', (e) => { if (e.key === '/') { e.preventDefault(); SELECTORS.search?.focus(); } });
        // Export notes
        document.getElementById('export-notes')?.addEventListener('click', exportNotes);
        document.getElementById('export-state')?.addEventListener('click', exportState);
        const importBtn = document.getElementById('import-state');
        const importFile = document.getElementById('import-file');
        importBtn?.addEventListener('click', () => importFile?.click());
        importFile?.addEventListener('change', onImportFile);
      }

      function populateChannelFilter() {
        const sel = SELECTORS.filterChannel;
        if (!sel) return;
        const channels = Array.from(state.channels).sort((a,b) => a.localeCompare(b));
        channels.forEach(ch => {
          const opt = document.createElement('option');
          opt.value = ch; opt.textContent = ch;
          sel.appendChild(opt);
        });
      }

      // URL state (shareable filters)
      function updateUrlFromFilters(replace=true) {
        const p = new URLSearchParams();
        const f = state.filters;
        if (f.q) p.set('q', f.q);
        if (f.section) p.set('s', f.section);
        if (f.channel) p.set('c', f.channel);
        if (f.watchlistOnly) p.set('wl', '1');
        if (f.watchedOnly) p.set('wd', '1');
        const url = location.pathname + (p.toString() ? '?' + p.toString() : '') + location.hash;
        (replace ? history.replaceState : history.pushState).call(history, null, '', url);
      }
      function applyFiltersFromUrl() {
        const p = new URLSearchParams(location.search);
        state.filters.q = p.get('q') || '';
        state.filters.section = p.get('s') || '';
        state.filters.channel = p.get('c') || '';
        state.filters.watchlistOnly = p.get('wl') === '1';
        state.filters.watchedOnly = p.get('wd') === '1';
        if (SELECTORS.search) SELECTORS.search.value = state.filters.q;
        if (SELECTORS.filterSection) SELECTORS.filterSection.value = state.filters.section;
        if (SELECTORS.filterChannel) SELECTORS.filterChannel.value = state.filters.channel;
        if (SELECTORS.filterWatchlist) SELECTORS.filterWatchlist.setAttribute('aria-pressed', String(state.filters.watchlistOnly));
        if (SELECTORS.filterWatched) SELECTORS.filterWatched.setAttribute('aria-pressed', String(state.filters.watchedOnly));
      }

      // Keyboard navigation between cards
      function setupKeyboardNav() {
        document.addEventListener('keydown', (e) => {
          const active = document.activeElement;
          const cards = Array.from(document.querySelectorAll('.card'));
          if (!cards.length) return;
          const idx = cards.indexOf(active.closest('.card'));
          const move = (i) => { if (i >=0 && i < cards.length) { cards[i].focus(); } };
          // Roving tabindex
          cards.forEach((c,i)=>{ c.tabIndex = (i===0?0:-1); });
          if (['ArrowDown','ArrowRight'].includes(e.key)) {
            if (idx >= 0) { e.preventDefault(); move(idx+1); }
            else move(0);
          } else if (['ArrowUp','ArrowLeft'].includes(e.key)) {
            if (idx >= 0) { e.preventDefault(); move(idx-1); }
          } else if (e.key === 'Enter' && idx >= 0) {
            const link = cards[idx].querySelector('.title a');
            if (link) { link.click(); }
          } else if (e.key === ' ' && idx >= 0) {
            e.preventDefault();
            // Space toggles Watched; Shift+Space toggles Watchlist
            if (e.shiftKey) cards[idx].querySelector('.actions .btn')?.click();
            else cards[idx].querySelector('.actions .btn + .btn')?.click();
          }
        }, true);
      }

      // Export notes as Markdown
      function exportNotes() {
        const parts = [];
        state.items.forEach(it => {
          const key = 'dive:notes:'+it.id;
          const val = localStorage.getItem(key);
          if (val && val.trim()) {
            parts.push(`- [${it.title}](${it.href})\n\n${val.trim()}\n`);
          }
        });
        const blob = new Blob([parts.join('\n') || '# No notes yet'], { type: 'text/markdown' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'dive-notes.md';
        document.body.appendChild(a); a.click(); a.remove();
        setTimeout(()=>URL.revokeObjectURL(url), 500);
      }

      // Export/Import watch state
      function exportState() {
        const payload = {
          v: 1,
          ts: new Date().toISOString(),
          watchlist: Array.from(state.watchlist),
          watched: Array.from(state.watched)
        };
        const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'dive-state.json';
        document.body.appendChild(a); a.click(); a.remove();
        setTimeout(()=>URL.revokeObjectURL(url), 500);
      }
      function onImportFile(e) {
        const file = e.target.files && e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          try {
            const data = JSON.parse(String(reader.result));
            if (!data || typeof data !== 'object') throw new Error('Invalid file');
            const wl = Array.isArray(data.watchlist) ? data.watchlist : [];
            const wd = Array.isArray(data.watched) ? data.watched : [];
            state.watchlist = new Set(wl);
            state.watched = new Set(wd);
            persist();
            render();
            updateUrlFromFilters(true);
          } catch (err) { console.warn('Import failed', err); }
          e.target.value = '';
        };
        reader.readAsText(file);
      }

      function parseOriginal(doc) {
        const h2s = Array.from(doc.querySelectorAll('h2'));
        h2s.forEach(h2 => {
          const text = h2.textContent.trim();
          const match = text.match(/^([A-G])\)\s*(.*)$/);
          if (!match) return;
          const code = match[1];
          const title = match[2];
          const table = h2.nextElementSibling?.tagName === 'DIV' ? h2.nextElementSibling.nextElementSibling : h2.nextElementSibling;
          if (!table || table.tagName !== 'TABLE') return;
          const rows = Array.from(table.querySelectorAll('tbody tr'));
          rows.forEach(tr => {
            const linkEl = tr.querySelector('.video-title a');
            const href = linkEl?.getAttribute('href') || '#';
            const vtitle = linkEl?.textContent?.trim() || 'Untitled';
            const channel = tr.querySelector('.channel')?.textContent?.trim() || '';
            const desc = tr.querySelector('.description')?.textContent?.trim() || '';
            const id = idFor(href, vtitle);
            state.items.push({ id, sectionCode: code, sectionTitle: title, title: vtitle, href, channel, description: desc });
            if (channel) state.channels.add(channel);
          });
        });
      }

      function bootstrap() {
        setUpControls();
        applyTheme();
        if (SELECTORS.themeToggle) SELECTORS.themeToggle.addEventListener('click', toggleTheme);

        // Prefer embedded template (standalone). Fallback to iframe if missing.
        if (SELECTORS.sourceTpl && SELECTORS.sourceTpl.content) {
          const frag = SELECTORS.sourceTpl.content.cloneNode(true);
          const temp = document.createElement('div');
          temp.appendChild(frag);
          parseOriginal(temp);
          SELECTORS.loading?.remove();
          populateChannelFilter();
          applyFiltersFromUrl();
          render();
          updateUrlFromFilters(true);
          updateProgress();
          setupKeyboardNav();
        } else {
          const iframe = document.createElement('iframe');
          iframe.src = 'dive_cohort_guide.html';
      // Theme handling
      function applyTheme() {
        document.documentElement.setAttribute('data-theme', state.theme);
        if (SELECTORS.themeToggle) SELECTORS.themeToggle.setAttribute('aria-pressed', state.theme === 'dark' ? 'true' : 'false');
      }
      function toggleTheme() {
        state.theme = state.theme === 'dark' ? 'light' : 'dark';
        localStorage.setItem('dive:theme', state.theme);
        applyTheme();
      }

      // YouTube thumbnail helper
      function youTubeId(url) {
        try {
          const u = new URL(url, location.href);
          if (u.hostname.includes('youtu.be')) return u.pathname.slice(1);
          if (u.searchParams.get('v')) return u.searchParams.get('v');
          return null;
        } catch { return null; }
      }
      function youTubeThumb(url) {
        const id = youTubeId(url);
        return id ? `https://i.ytimg.com/vi/${id}/hqdefault.jpg` : null;
      }
          iframe.tabIndex = -1;
          iframe.title = 'source-loader';
          iframe.style.cssText = 'display:none;width:0;height:0;border:0;';
          iframe.onload = () => {
            try {
              const doc = iframe.contentDocument || iframe.contentWindow.document;
              parseOriginal(doc);
              SELECTORS.loading?.remove();
              populateChannelFilter();
              applyFiltersFromUrl();
              render();
              updateUrlFromFilters(true);
              setupKeyboardNav();
            } catch (e) {
              console.warn('Parse failed', e);
              SELECTORS.loading?.classList.remove('hidden');
            }
          };
          document.body.appendChild(iframe);
          updateProgress();
        }
      }

      bootstrap();
    })();
  </script>
</body>
</html>
